**核心理念**

*   **原则：质量是第一位的。在保证质量的前提下，才可以追求性能和功能。如果性能上的改进会导致质量的下降，那就不值得做。质量不只是稳定性和可用性，也包括代码的质量。代码劣质，就是质量劣质。质量和速度并不对立，高质量系统可以有更高效率的产出，而不需要浪费时间和人力在还清技术债务上。**
    *   **困难：** 在中国互联网行业，普遍存在“快速迭代”、“唯快不破”的文化。项目往往追求短期上线和快速实现功能，对质量的投入容易被忽视。代码质量、技术债务等长期问题，在面对紧迫的上线压力时，往往会被牺牲。
    *   **根本原因：**
        *   市场竞争激烈，产品生命周期短，强调快速占领市场和验证商业模式。
        *   绩效考核往往侧重于功能交付速度和数量，而非代码质量和系统长期健康度。
        *   技术管理层可能缺乏对高质量软件长期价值的认知，或难以抵挡业务部门的短期压力。
        *   工程师可能缺乏对高质量代码的追求和实践经验，或在压力下被迫妥协。

**设计与架构**

*   **原则：设计应由一两个人做出，以保证概念的完整和一致。设计的粒度应该适当，既不过于粗略，也不过于细化，避免过多限制实现的方式。如果时间精力不够，可以将设计工作委托他人。但不可以因为不懂而委托他人。**
    *   **困难：** 在一些大型组织中，设计过程可能被过度流程化，需要多层审批和多人参与，导致效率低下和设计妥协。也可能存在“人人都是设计师”的情况，缺乏核心的、有经验的设计主导者。
    *   **根本原因：**
        *   组织层级多，决策链长，导致设计需要经过多方确认。
        *   对个人能力不信任，倾向于通过集体决策来分散风险。
        *   缺乏具备深厚技术功底和全局观的核心设计人才。
        *   “不懂而委托”可能源于技术管理者的技术能力不足或不愿承担责任。

*   **原则：架构设计，就是设计各个组件之间的接口。从大组件到小组件，都应该先定义接口，再实现。接口应有明确且简洁的语义。如 Unix 哲学所说，"do one thing and do it well"。如果现有接口语义不符合需要，就重新定义，而不是打补丁。通过合并和拆分等方式，使新的语义仍然明确且简洁。**
    *   **困难：** 实际开发中，由于需求变化快或前期考虑不周，接口设计容易变得臃肿、职责不清。为了快速实现功能，倾向于在现有接口上打补丁，而不是进行彻底的重构和重新设计。
    *   **根本原因：**
        *   需求不稳定性高，导致前期难以做出稳定的接口设计。
        *   缺乏对“接口优先”设计理念的深入理解和实践。
        *   重构成本高，且短期内难以看到直接的业务价值，优先级低。
        *   工程师可能缺乏设计清晰、简洁接口的能力和意识。

*   **原则：简洁是相对的，当前认为简洁的设计，可能仍然可以改进，所以需要不断重构。因为接口会有合并和拆分的过程，实现也同样会有合并和拆分，所以“可组合性”是重要的。可组合性更强，合并和拆分就更容易。接口语义不明，语义太多，就难以拆散和组合，就是重构的阻碍。**
    *   **困难：** 重构往往被视为“返工”或“没有新功能产出”，难以获得足够的时间和资源投入。缺乏对“可组合性”和“持续重构”作为提升长期效率手段的认知。
    *   **根本原因：**
        *   绩效考核不鼓励或不认可重构工作。
        *   业务压力大，没有“闲暇”时间进行重构。
        *   团队缺乏重构的技能和经验。
        *   技术债务的危害是渐进的，短期内不明显，容易被忽视。

*   **原则：避免在需求不够清晰时过度设计，因为设计还可能迭代多次，所以没必要过于细化。不断重构，软件才能渐趋完美。没有任何设计是从一开始就完美的，所以重构理应是预期中的过程。没有设计，实现就会混乱，难以被所有人理解，质量就会低下。**
    *   **困难：** 容易走向两个极端：要么完全不做设计，直接开始编码；要么在需求不明确时进行过度设计，导致浪费。对“演进式设计”和“持续重构”的理念接受度不高。
    *   **根本原因：**
        *   缺乏对不同阶段设计深度的把握能力。
        *   对需求变化缺乏有效管理和应对机制。
        *   团队缺乏共同的设计语言和协作方式。

**开发流程**

*   **原则：尽早实现原型并开始演化，避免过早过度设计。软件开发包括设计、实现、重构、测试、优化、除错等相互关联的过程。最重要的是设计。实现和重构，都应该多次进行，让设计不断进化，趋于最佳。一次改动（例如一个拉取请求）应尽可能只做一件事，好处包括：容易调试除错、容易测量影响、需要回滚时影响更小、更容易让成员评审等。**
    *   **困难：** 倾向于一次性提交大量代码，包含多个不相关的功能或修改，导致代码评审困难、问题定位复杂。对“小步快跑”、“持续集成/持续交付”的实践不到位。
    *   **根本原因：**
        *   缺乏精细化的任务拆解能力。
        *   追求一次性完成“大任务”，忽视过程中的风险。
        *   代码评审文化不健全或流于形式。
        *   CI/CD 工具链和流程不完善。

**质量与测试**

*   **原则：在设计、实现、重构、优化、部署等过程里，错漏发现得越早，就越容易修复。最好的除错手段，就是不让错误发生。设计和实现越好，错漏就越难以藏身。设计混乱，出现问题不重新设计，只是到处打补丁，就是藏污纳垢的系统。测试贯穿于所有过程，不可缺少。测试可以保证正确性，是重构过程的基石。良好而完备的测试，可以为重构过程带来信心。**
    *   **困难：** 测试往往被视为开发完成后的一个独立阶段，而不是贯穿始终的活动。对测试的投入不足，尤其是单元测试和自动化测试。
    *   **根本原因：**
        *   测试人员不足或测试技能不全面。
        *   开发人员缺乏编写高质量测试的意识和能力。
        *   项目周期短，测试时间被压缩。
        *   缺乏对测试在保证质量和支持重构中的关键作用的认知。

*   **原则：测试应该有大粒度的，也要有小粒度的。不同粒度的测试，可以暴露不同粒度的错漏。测试应该容易写，应该允许方便地切入系统某一部分做测试。接口明确且简洁，就更容易针对测试需要的场景，使用模拟的实现，更具“可测试性”。任何错漏，都应该用单元测试复现，再修正，而不是手工复现。这样可以保证，错漏修正之后，测试可以一直自动跑，保证以后不会再有同样的错漏。如果难以用单元测试的方式复现错漏，那说明整个架构有问题，应该消除一切阻碍自动化单元测试的因素。**
    *   **困难：** 单元测试覆盖率低，集成测试和端到端测试不稳定。难以针对特定场景编写自动化测试，尤其是在系统耦合度高、接口不清晰的情况下。倾向于手工回归测试。
    *   **根本原因：**
        *   缺乏对测试分层和不同粒度测试作用的理解。
        *   系统设计耦合度高，难以进行单元测试和模拟。
        *   缺乏编写可测试代码的实践经验。
        *   对自动化测试的投入不足，包括工具和平台建设。

*   **原则：测试应该尽可能快速，修正错漏或者优化时，可以得到快速的反馈，提高效率。测试也会一直被自动执行很多次，所以跑得越快越好。尽可能杜绝手工测试。正确性测试和性能测试，应该全部程序化，使不同人在不同环境，都能方便地重复地进行。内部人员在报告错漏时，应提供程序化的复现方式。如果难以做到程序化，就先重构系统，使其容易做到。除错过程里，也可能发现设计中的问题，应该侧重于修正设计问题，而不是给实现打补丁。**
    *   **困难：** 自动化测试执行慢，反馈周期长。仍然大量依赖手工测试进行验证。内部报告问题时，缺乏提供程序化复现步骤的习惯和能力。除错时倾向于快速打补丁，而不是深入分析和修正设计问题。
    *   **根本原因：**
        *   自动化测试框架和基础设施性能不足。
        *   缺乏对测试效率和反馈速度重要性的认知。
        *   团队缺乏编写可复现 bug 报告的训练。
        *   解决问题的思维模式倾向于“头痛医头，脚痛医脚”，缺乏系统性思考。

**性能优化**

*   **原则：在设计相对稳定之后，才开始优化实现的性能。优化应该基于量化指标，而不是直觉。指标测量应明确使用的工具和过程，确保排除人和环境的影响。测量组件或者代码也应经过测试过程，以避免错误。可以引入多套测量，并交叉验证，以避免错误。错误的测量比没有测量更糟糕，基于错误测量的决策，会造成相当大的时间或人力浪费。不应过早优化细节，应该设计相对稳定，正确性得到保证之后，再优化细节。**
    *   **困难：** 容易过早进行性能优化，甚至在设计和正确性尚未确定的阶段。优化往往基于直觉或片面数据，缺乏系统性的性能分析和测量方法。
    *   **根本原因：**
        *   缺乏对性能优化时机的正确判断。
        *   缺乏专业的性能分析工具和技能。
        *   对测量结果的解读和验证能力不足。
        *   容易受到“微优化”的诱惑，忽视了更重要的架构和算法层面的优化。

**环境与工具**

*   **原则：开发或者生产环境，应能方便地搭建。搭建过程应尽量减少手工输入，避免出错。开发或者生产环境，应能方便地创建快照，包括数据快照和程序快照。每个开发者应有单独的开发环境，禁止共用开发环境，禁止多人、同步、手工复现等调试方式。在开发环境复现生产环境的错漏，应该尽可能方便。如果不方便，就不断重构直到可以方便重现。用代码管理所有的环境配置，纳入版本管理。使用自动化工具，结合人工智能，强化原则的实施。**
    *   **困难：** 开发和生产环境搭建复杂，依赖人工操作，容易出错。缺乏标准化的环境配置和版本管理。难以快速创建环境快照。共用开发环境或依赖手工调试的情况仍然存在。复现生产问题困难。自动化工具和人工智能在开发流程中的应用不足。
    *   **根本原因：**
        *   缺乏对基础设施自动化和配置即代码的投入。
        *   历史遗留系统导致环境复杂。
        *   缺乏对独立开发环境重要性的认知。
        *   缺乏相应的工具链和平台支持。
        *   对人工智能在软件工程中的应用尚处于探索阶段。

**可观测性与接口**

*   **原则：系统里正在发生的、发生过的、将要发生的事情，应能方便地获知。文本、图形、查询语言等界面，都应该尽量提供，而不是局限于一种。不同界面应使用同样的数据源，避免不一致。**
    *   **困难：** 系统缺乏统一、全面的日志、监控和追踪系统。可观测性工具不完善，数据分散，难以快速定位问题和理解系统行为。
    *   **根本原因：**
        *   缺乏对可观测性重要性的认知和投入。
        *   缺乏统一的技术栈和标准。
        *   工具和平台建设滞后。

**组织与文化**

*   **原则：组织的成员，应有共同的理念和追求。注重质量而不是数量，推崇脑力而不是体力，讲究平等而不是倾轧，开放而不混乱，守纪而不迂腐，敢于直言和面对诤言，拥抱变化而不忘记初衷。避免固化的层级式的组织。针对具体的任务或者关注点，设立小队。一位成员可以属于不同的小队。队内的分工应明确。尽量使用人工智能来替代中层角色，以避免这些问题：信息传递失真、决策缓慢、限制成员自主性和创造力等。人工智能做得好的事情，就让人工智能来做。避免使用机械化的效能评价指标，如代码量之类。隐藏评价标准，以避免针对性的优化和博弈。组织的理念不一定在任何情况下都可以践行，如果不得不做有违理念的事情，需要做好隔离和切割，尽力降低对组织和理念的影响。对于新加入的成员，需要有良好的引导和培训，帮助他们理解组织的理念，以及合适的实践方式。尊重每一位成员，维护成员的动力和热情，维护积极、有趣、安全的工作环境。沟通应该尽量高效。设计良好的系统和组织，容易被理解和运作，需要的沟通就少。沟通应该异步。同步的会议会无谓消耗所有人的时间和精力，应该在有限的情况下使用：紧急问题处理、复杂问题同步等。沟通应该有书面记录和可搜索，方便将来的使用，及人工智能的处理。沟通应该多提供事实，避免过早判断，避免A-B问题。沟通应使用共同认可的概念集，避免使用不同的词汇表，导致理解偏差。如果项目参与者之间存在多套的术语系统，应尽快纠正为统一的一套。进度的跟踪，优先使用人工智能实现。将所有设计、代码、及其他活动记录作为输入，得出当前进度。不是所有人都会因践行原则而受益。有些角色的利益关系，天然和原则冲突，所以应尽量减少组织内这类角色。例如有些角色的目标只是短期的表面的进度和效果，并不关心长期的质量或者技术债务，所以不可以让这类角色主导工作。或者将成员与职责分离，让成员动态地轮流担任这类职责，使利益一体化，减少冲突。**
    *   **困难：** 这是最核心也是最难的部分。在中国，传统的层级式管理、强调执行而非独立思考、绩效导向短期结果、以及人际关系复杂性等因素，都可能与这些原则产生冲突。建立开放、平等、敢于直言的文化需要长期努力。推广异步沟通和书面记录习惯困难。人工智能在组织管理中的应用尚不成熟且存在伦理和信任问题。改变固有的利益结构和评价体系阻力大。
    *   **根本原因：**
        *   深厚的传统文化影响，强调层级、权威和集体而非个体。
        *   快速发展的行业背景下，组织结构和管理模式尚未完全适应。
        *   绩效考核体系设计不合理，导致行为短期化。
        *   缺乏有效的沟通和协作工具及文化。
        *   对人工智能能力的认知和信任不足。
        *   改变既得利益者的阻力。

**原则的演进**

*   **原则：上述理念并不是真理，需要持续的改进。尤其需要关注这些方面：在实际环境下难以实践、有更好的替代理念、因为预设条件变化而变得过时、容易表面上被遵循，但实际有悖根本原则，沦为教条。**
    *   **困难：** 缺乏对原则进行定期回顾、讨论和修订的机制。容易将原则视为固定不变的教条，而不是需要持续演进的指导方针。
    *   **根本原因：**
        *   缺乏持续改进和反思的文化。
        *   没有明确的责任人或团队负责原则的维护和演进。
        *   组织忙于日常业务，没有时间和精力投入到原则本身的优化上。

